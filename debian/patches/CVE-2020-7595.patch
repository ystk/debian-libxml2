From: Markus Koschany <apo@debian.org>
Date: Tue, 8 Sep 2020 12:44:03 +0200
Subject: CVE-2020-7595

Bug-Debian: https://bugs.debian.org/949582
Origin: https://gitlab.gnome.org/GNOME/libxml2/commit/0e1a49c8907645d2e155f0d89d4d9895ac5112b5
---
 parser.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/parser.c b/parser.c
index f59adb5..b3a490b 100644
--- a/parser.c
+++ b/parser.c
@@ -2776,7 +2776,8 @@ xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
     else
         c = 0;
     while ((c != 0) && (c != end) && /* non input consuming loop */
-	   (c != end2) && (c != end3)) {
+           (c != end2) && (c != end3) &&
+           (ctxt->instate != XML_PARSER_EOF)) {
 
 	if (c == 0) break;
         if ((c == '&') && (str[1] == '#')) {
