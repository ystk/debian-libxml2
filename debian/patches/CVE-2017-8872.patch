From: Markus Koschany <apo@debian.org>
Date: Tue, 8 Sep 2020 14:38:38 +0200
Subject: CVE-2017-8872

Bug-Debian: https://bugs.debian.org/862450
Origin: https://gitlab.gnome.org/GNOME/libxml2/commit/123234f2cfcd9e9b9f83047eee1dc17b4c3f4407
---
 parser.c | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/parser.c b/parser.c
index 87c32a7..b3a490b 100644
--- a/parser.c
+++ b/parser.c
@@ -12665,7 +12665,12 @@ xmlHaltParser(xmlParserCtxtPtr ctxt) {
 	    ctxt->input->free((xmlChar *) ctxt->input->base);
 	    ctxt->input->free = NULL;
 	}
+        if (ctxt->input->buf != NULL) {
+            xmlFreeParserInputBuffer(ctxt->input->buf);
+            ctxt->input->buf = NULL;
+        }
 	ctxt->input->cur = BAD_CAST"";
+        ctxt->input->length = 0;
 	ctxt->input->base = ctxt->input->cur;
     }
 }
